---
title       : Chapter 1 explorations
subtitle    : Maternal smoking and birth weight -- descriptive statistics
author      : Andrew Irwin
job         : Math 3321
framework   : io2012        # {io2012, html5slides, shower, dzslides, ...}
highlighter : highlight.js  # {highlight.js, prettify, highlight}
hitheme     : tomorrow      # 
widgets     : [mathjax]            # {mathjax, quiz, bootstrap}
mode        : selfcontained # {standalone, draft}
github:
  user:AndrewIrwin
  repo:math3321
---

## Load the data

```{r}
babies = read.table("http://www.stat.berkeley.edu/users/statlabs/data/babiesI.data", header=TRUE)
```

Alternatively, download the file to your computer and load it from your disk
```{r}
babies = read.table("~/Desktop/babiesI.data", header=TRUE)
```

---
Look at the top of the file to be sure it loaded okay:
```{r}
head(babies)
```

* Question. What happens if you forget the "header=TRUE" part?

----
## Quantitative summaries

Get a summary of the data:
```{r}
summary(babies)
```
What are the units for bwt?

---
Why is "smoke" not just 0 or 1? Take a closer look
```{r}
table(babies$smoke)
```

The book doesn't tell me what those 9s are, but the textbook website says it means smoking status is unknown. Replace them with NAs
```{r}
babies$smoke = replace(babies$smoke, babies$smoke == 9, NA)
```

---
Summary computes the mean, median, quartiles, min, max, but not the variance or standard deviation:
```{r}
var(babies$bwt)
sd(babies$bwt)
```

Is that the variance and standard deviation of the population (dividing by n) or the bias-corrected value for a sample (dividing by n-1)? 

---
## Write your own var and sd functions to check with the built-in ones do:
```{r}
my.var = function(x) mean( (x - mean(x))^2)
my.sd = function(x) sqrt(my.var(x))
my.var(babies$bwt)
my.sd(babies$bwt)
```
So it's the bias corrected value, off by a factor of $(n-1)/n$ which can be confirmed by computing the ratio of the two variances
```{r}
(nrow(babies) - 1) / nrow(babies)
my.var(babies$bwt)/var(babies$bwt)
```

---
Does the distribution of birth weights differ between smoking and non-smoking mothers? Here are two similar ways of doing the same thing. The "aggregate" method has a nicer name and you can add other variables to the grouping list "by"

```{r}
tapply(babies$bwt, babies$smoke, mean)
aggregate(babies$bwt, by=list(babies$smoke), mean)
```

---
Here are some more aggregated results
```{r}
aggregate(babies$bwt, by=list(babies$smoke), summary)
aggregate(babies$bwt, by=list(babies$smoke), sd)
```

---
## Qualitative summaries

Start with a histogram.
```{r fig.height=6}
hist(babies$bwt)
```

---
Then try a boxplot
```{r fig.height=6}
boxplot(babies)
```

---
Fix that!
```{r fig.height=6}
boxplot(bwt ~ smoke, data=babies, xlab="Smoker?", ylab="Birth weight (oz)")
```

---
Compare smoking and non-smoking mothers side by side
```{r fig.height=6, fig.width=13}
par(mfrow=c(1,2))
hist(babies$bwt[babies$smoke == 0])
hist(babies$bwt[babies$smoke == 1])
par(mfrow=c(1,1))
```

---
Fix the scales and labels
```{r fig.width=13, fig.height=6}
par(mfrow=c(1,2))
hist(babies$bwt[babies$smoke == 0], xlim=range(babies$bwt), ylim=c(0, 200), main="Non-smokers", xlab="Birth weight (oz)")
hist(babies$bwt[babies$smoke == 1], xlim=range(babies$bwt), ylim=c(0, 200), main="Smokers", xlab="Birth weight (oz)")
par(mfrow=c(1,1))
```

---
What do quantile plots show?
```{r fig.width=8, fig.height=6}
qqnorm(babies$bwt)
qqline(babies$bwt)
```

---
Compare the birth weight data to a uniform distribution
```{r fig.width=8, fig.height=6}
u = runif(nrow(babies))
qqplot(u, babies$bwt)
```

---
### Categories and tables

```{r}
table( cut(babies$bwt, c(0, 100, 125, 150, 200)), babies$smoke)
```

---
### Define 'low birth weight' from histogram
```{r}
table( babies$bwt < 100, babies$smoke)
```

---
What about a different threshold?
```{r}
table( babies$bwt < 90, babies$smoke)
table( babies$bwt < 120, babies$smoke)
```


